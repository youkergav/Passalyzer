function reset(){$("#grpPassword #outResult").slideUp(function(){$("#grpPassword #outResult").removeClass("alert-success alert-warning alert-danger"),$("#grpPassword #outResult h4.alert-heading").html(""),$("#grpPassword #outResult span.alert-message").html(""),$(".list-group-item").remove(),$(".tab-pane").remove(),$("#btnLess").addClass("d-none"),$("#btnLess").removeClass("d-inline"),$("#btnMore").addClass("d-inline"),$("#btnMore").removeClass("d-none"),$("#grpResult").hide();for(var t=$("#grpPassword #grpResult tbody tr"),a=0;a<t.length;a++)$(t[a]).remove()}),$("#inPassword").blur()}function showLoading(){reset(),$("#btnAnalyze").html($("#btnAnalyze").data("loading-text"))}function showInfo(t){switch(t){case"danger":$("#grpPassword #outResult").addClass("alert-danger"),$("#grpPassword #outResult h4.alert-heading").html("Oh no!"),$("#grpPassword #outResult span.alert-message").html("Your password has been compromised. Please change your password immediately."),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-danger active").attr("id","list-problems-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-problems").html("Problems")),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-danger").attr("id","list-solutions-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-solutions").html("Solutions")),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-danger").attr("id","list-stats-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-stats").html("Statistics")),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-danger").attr("id","list-matches-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-matches").html("Matches")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade show active").attr("id","list-problems").attr("role","tabpanel")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade").attr("id","list-solutions").attr("role","tabpanel")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade").attr("id","list-stats").attr("role","tabpanel")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade").attr("id","list-matches").attr("role","tabpanel")),$("#grpPassword #outResult").reveal();break;case"warning":$("#grpPassword #outResult").addClass("alert-warning"),$("#grpPassword #outResult h4.alert-heading").html("Weak Password!"),$("#grpPassword #outResult span.alert-message").html("Your password is easy to crack. We highly recommend changing your password."),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-warning active").attr("id","list-problems-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-problems").html("Problems")),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-warning").attr("id","list-solutions-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-solutions").html("Solutions")),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-warning").attr("id","list-stats-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-stats").html("Statistics")),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-warning").attr("id","list-matches-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-matches").html("Matches")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade show active").attr("id","list-problems").attr("role","tabpanel")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade").attr("id","list-solutions").attr("role","tabpanel")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade").attr("id","list-stats").attr("role","tabpanel")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade").attr("id","list-matches").attr("role","tabpanel")),$("#grpPassword #outResult").reveal();break;case"success":$("#grpPassword #outResult").addClass("alert-success"),$("#grpPassword #outResult h4.alert-heading").html("Good news!"),$("#grpPassword #outResult span.alert-message").html("Your password has been checked and deemed safe to use."),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-success active").attr("id","list-stats-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-stats").html("Statistics")),$("#list-tab-result").append($("<a></a>").addClass("list-group-item list-group-item-action list-group-item-success").attr("id","list-matches-list").attr("data-toggle","list").attr("role","tab").attr("href","#list-matches").html("Matches")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade show active").attr("id","list-stats").attr("role","tabpanel")),$("#nav-tabContent-result").append($("<div></div>").addClass("tab-pane fade").attr("id","list-matches").attr("role","tabpanel")),$("#grpPassword #outResult").reveal()}}function showMatches(t,a){$("#list-matches").append($("<div></div>").addClass("table-responsive").append($("<table></table>").attr("id","table-matches").addClass("table text-center").append($("<tr></tr>").append($("<th></th>").addClass("border-header-"+a).attr("col","row").html("Found")).append($("<th></th>").addClass("border-header-"+a).attr("col","row").html("Pattern")).append($("<th></th>").addClass("border-header-"+a).attr("col","row").html("Entropy")).append($("<th></th>").addClass("border-header-"+a).attr("col","row").html("Matches")))));for(var s=0;s<t.length;s++){var e=t[s].token,l=t[s].pattern.charAt(0).toUpperCase()+t[s].pattern.slice(1);0!=Math.floor(t[s].entropy)?entropy=t[s].entropy.toFixed(3)+" bits":entropy="&mdash;",t[s].matchedWord?word=t[s].matchedWord:word="&mdash;",0==s?$("#list-matches table").append($("<tr></tr>").addClass("table-"+a).append($("<td></td>").addClass("border-0").html(e)).append($("<td></td>").addClass("border-0").html(l)).append($("<td></td>").addClass("border-0").html(entropy)).append($("<td></td>").addClass("border-0").html(word))):$("#list-matches table").append($("<tr></tr>").addClass("table-"+a).append($("<td></td>").html(e)).append($("<td></td>").html(l)).append($("<td></td>").html(entropy)).append($("<td></td>").html(word)))}}function formatSeconds(t){var a=Math.floor(t/31536e3),s=Math.floor(t%31536e3/2592e3),e=Math.floor(t%31536e3%2592e3/86400),l=Math.floor(t%31536e3%2592e3%86400/3600),r=Math.floor(t%31536e3%2592e3%86400%3600/60),i=(t=Math.floor(t%31536e3%2592e3%86400%3600)%60,"");if(0<a)999<a?i+=a.toLocaleString()+" years":(i+=1==a?a.toLocaleString()+" year ":a.toLocaleString()+" years ",i+=1==s?s+" month ":s+" months ",i+=1==e?e+" day ":e+" days ",i+=1==l?l+" hour ":l+" hours ",i+=1==r?r+" minute and ":r+" minutes and ",i+=1==t?t+" second":t+" seconds");else if(0<s)i+=1==s?s+" month ":s+" months ",i+=1==e?e+" day ":e+" days ",i+=1==l?l+" hour ":l+" hours ",i+=1==r?r+" minute and ":r+" minutes and ",i+=1==t?t+" second":t+" seconds";else if(0<e)i+=1==e?e+" day ":e+" days ",i+=1==l?l+" hour ":l+" hours ",i+=1==r?r+" minute and ":r+" minutes and ",i+=1==t?t+" second":t+" seconds";else if(0<l)i+=1==l?l+" hour ":l+" hours ",i+=1==r?r+" minute and ":r+" minutes and ",i+=1==t?t+" second":t+" seconds";else if(0<r)i+=1==r?r+" minute and ":r+" minutes and ",i+=1==t?t+" second":t+" seconds";else{if(!(0<t))return"less than a second";i+=1==t?t+" second":t+" seconds"}return i}function parsePassword(t){t&&$.ajax({dataType:"JSON",url:"api/password/"+encodeURIComponent(t),success:function(t){switch(t.score){case 0:case 1:showInfo("danger"),t.breached&&($("#list-problems").append($("<h5></h5>").html("Database Breach")),$("#list-problems").append($("<ul></ul>").append($("<li></li>").html("Your password has been leaked in a publically avalible database breach.")).append($("<li></li>").html("Hackers have a very high chance of exposing this password."))),$("#list-solutions").append($("<h5></h5>").html("Change Your Password")),$("#list-solutions").append($("<ul></ul>").append($("<li></li>").html("Avoid using this password at all costs. It is no longer safe to use.")).append($("<li></li>").html("Use a different password that has not been found in a database breach.")))),$("#list-problems").append($("<h5></h5>").html("Crack Time")),$("#list-problems").append($("<ul></ul>").append($("<li></li>").html("Your password is easy to crack.")).append($("<li></li>").html("Hackers can exposed your password quickly with a combination of bruteforce and dictonary attacks."))),$("#list-solutions").append($("<h5></h5>").html("Increase Password Strength")),$("#list-solutions").append($("<ul></ul>").append($("<li></li>").html("Make the password more unique.")).append($("<li></li>").html("Add special characters and numbers to the password so it can't be easily guessed."))),showMatches(t.matches,"danger");break;case 2:case 3:t.breached?(showInfo("danger"),$("#list-problems").append($("<h5></h5>").html("Database Breach")),$("#list-problems").append($("<ul></ul>").append($("<li></li>").html("Your password has been leaked in a publically avalible database breach.")).append($("<li></li>").html("Hackers have a very high chance of exposing this password."))),$("#list-problems").append($("<h5></h5>").html("Crack Time")),$("#list-problems").append($("<ul></ul>").append($("<li></li>").html("Your password can be cracked over time.")).append($("<li></li>").html("With enough time, hackers can exposed your password with a combination of bruteforce and dictonary attacks."))),$("#list-solutions").append($("<h5></h5>").html("Change Your Password")),$("#list-solutions").append($("<ul></ul>").append($("<li></li>").html("Avoid using this password at all costs. It is no longer safe to use.")).append($("<li></li>").html("Use a different password that has not been found in a database breach."))),$("#list-solutions").append($("<h5></h5>").html("Increase Password Strength")),$("#list-solutions").append($("<ul></ul>").append($("<li></li>").html("Add more special characters and numbers to the password so it can't be easily guessed.")).append($("<li></li>").html("Avoid keywords and use phrases instead.")).append($("<li></li>").html('Don\'t just replace letters with special character "lookalikes". <i>Example: "password" and "p@$$w0rd"</i>'))),showMatches(t.matches,"danger")):(showInfo("warning"),$("#list-problems").append($("<h5></h5>").html("Crack Time")),$("#list-problems").append($("<ul></ul>").append($("<li></li>").html("Your password can be cracked over time.")).append($("<li></li>").html("With enough time, hackers can exposed your password with a combination of bruteforce and dictonary attacks."))),$("#list-solutions").append($("<h5></h5>").html("Increase Password Strength")),$("#list-solutions").append($("<ul></ul>").append($("<li></li>").html("Add more special characters and numbers to the password so it can't be easily guessed.")).append($("<li></li>").html("Avoid keywords and use phrases instead.")).append($("<li></li>").html('Don\'t just replace letters with special character "lookalikes". <i>Example: "password" and "p@$$w0rd"</i>'))),showMatches(t.matches,"warning"));break;case 4:t.breached?(showInfo("danger"),$("#list-problems").append($("<h5></h5>").html("Database Breach")),$("#list-problems").append($("<ul></ul>").append($("<li></li>").html("Your password has been leaked in a publically avalible database breach.")).append($("<li></li>").html("Hackers have a very high chance of exposing this password."))),$("#list-solutions").append($("<h5></h5>").html("Change Your Password")),$("#list-solutions").append($("<ul></ul>").append($("<li></li>").html("Avoid using this password at all costs. It is no longer safe to use.")).append($("<li></li>").html("Use a different password that has not been found in a database breach."))),showMatches(t.matches,"danger")):(showInfo("success"),showMatches(t.matches,"success"))}$("#list-stats").append($("<h5></h5>").html("Characters")),$("#list-stats").append($("<ul></ul>").append($("<li></li>").html("This password has <i>"+t.lenPass+" characters</i> in total.")).append($("<li></li>").html("This password has <i>"+t.lenAlpha+" alphabetical</i> characters.")).append($("<li></li>").html("This password has <i>"+t.lenNumeric+" numerical</i> characters.")).append($("<li></li>").html("This password has <i>"+t.lenSpecial+" special</i> characters."))),$("#list-stats").append($("<h5></h5>").html("Cracking")),$("#list-stats").append($("<ul></ul>").append($("<li></li>").html("This password has <i>"+t.entropy.toFixed(3)+" bits</i> of entropy.")).append($("<li></li>").html("It would take <i>"+formatSeconds(t.timeCrack)+"</i> to crack this password.</i>"))),$("#btnAnalyze").html("Analyze")},statusCode:{500:function(){$("#grpPassword #outError").reveal(),$("#btnAnalyze").html("Analyze")}}})}jQuery.fn.extend({reveal:function(){this.hide(),this.removeClass("d-none"),this.slideDown()}});